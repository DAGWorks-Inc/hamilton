{"eventTime": "2024-09-05T07:00:38.468992+00:00", "eventType": "START", "inputs": [], "job": {"facets": {"jobType": {"_producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "_schemaURL": "https://openlineage.io/spec/facets/2-0-3/JobTypeJobFacet.json#/$defs/JobTypeJobFacet", "integration": "Hamilton", "jobType": "DAG", "processingType": "BATCH"}, "sourceCode": {"_producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-1/SourceCodeJobFacet.json#/$defs/SourceCodeJobFacet", "language": "python", "sourceCode": "[{\"name\": \"db_dataset.loader\", \"tags\": {\"module\": \"__main__\", \"hamilton.data_loader\": true, \"hamilton.data_loader.has_metadata\": true, \"hamilton.data_loader.source\": \"db_dataset\", \"hamilton.data_loader.classname\": \"db_dataset()\", \"hamilton.data_loader.node\": \"loader\"}, \"output_type\": \"tuple\", \"required_dependencies\": [\"db_client\"], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef db_dataset(db_client: object) -> Tuple[pd.DataFrame, dict]:\\n    query = \\\"SELECT * FROM purchase_data\\\"\\n    return pd.read_sql(query, con=db_client), {\\\"sql_metadata\\\": {\\\"query\\\": query, \\\"table_name\\\": \\\"purchase_data\\\", \\\"database\\\": \\\"sqlite\\\"}}\\n\", \"documentation\": \"\", \"version\": \"7903e84928e9adc7575d7285170c9f2f2855a5adb2f5924656cd7fb01377ee8b\"}, {\"name\": \"db_dataset\", \"tags\": {\"hamilton.data_loader\": true, \"hamilton.data_loader.has_metadata\": false, \"hamilton.data_loader.source\": \"db_dataset\", \"hamilton.data_loader.classname\": \"db_dataset()\", \"hamilton.data_loader.node\": \"db_dataset\"}, \"output_type\": \"DataFrame\", \"required_dependencies\": [\"db_dataset.loader\"], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef db_dataset(db_client: object) -> Tuple[pd.DataFrame, dict]:\\n    query = \\\"SELECT * FROM purchase_data\\\"\\n    return pd.read_sql(query, con=db_client), {\\\"sql_metadata\\\": {\\\"query\\\": query, \\\"table_name\\\": \\\"purchase_data\\\", \\\"database\\\": \\\"sqlite\\\"}}\\n\", \"documentation\": \"\", \"version\": \"7903e84928e9adc7575d7285170c9f2f2855a5adb2f5924656cd7fb01377ee8b\"}, {\"name\": \"file_dataset.loader\", \"tags\": {\"module\": \"__main__\", \"hamilton.data_loader\": true, \"hamilton.data_loader.has_metadata\": true, \"hamilton.data_loader.source\": \"file_dataset\", \"hamilton.data_loader.classname\": \"file_dataset()\", \"hamilton.data_loader.node\": \"loader\"}, \"output_type\": \"tuple\", \"required_dependencies\": [\"file_ds_path\"], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef file_dataset(file_ds_path: str) -> Tuple[pd.DataFrame, dict]:\\n    # TODO: metadata\\n    df = pd.read_csv(file_ds_path)\\n    return df, utils.get_file_metadata(file_ds_path)\\n\", \"documentation\": \"\", \"version\": \"fe990a80cc2567d540dc183f180c86d3a77b72224d180a95d1719cc766ccb5fa\"}, {\"name\": \"file_dataset\", \"tags\": {\"hamilton.data_loader\": true, \"hamilton.data_loader.has_metadata\": false, \"hamilton.data_loader.source\": \"file_dataset\", \"hamilton.data_loader.classname\": \"file_dataset()\", \"hamilton.data_loader.node\": \"file_dataset\"}, \"output_type\": \"DataFrame\", \"required_dependencies\": [\"file_dataset.loader\"], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef file_dataset(file_ds_path: str) -> Tuple[pd.DataFrame, dict]:\\n    # TODO: metadata\\n    df = pd.read_csv(file_ds_path)\\n    return df, utils.get_file_metadata(file_ds_path)\\n\", \"documentation\": \"\", \"version\": \"fe990a80cc2567d540dc183f180c86d3a77b72224d180a95d1719cc766ccb5fa\"}, {\"name\": \"fit_model\", \"tags\": {\"module\": \"__main__\"}, \"output_type\": \"ModelObject\", \"required_dependencies\": [\"joined_dataset\"], \"optional_dependencies\": [], \"source\": \"def fit_model(joined_dataset: pd.DataFrame) -> ModelObject:\\n    # model = ...\\n    return ModelObject()\\n\", \"documentation\": \"\", \"version\": \"bdde123068c590c85d72c44ad02e113fb3419efe974282346c15fad2bb4364dc\"}, {\"name\": \"joined_dataset\", \"tags\": {\"module\": \"__main__\"}, \"output_type\": \"DataFrame\", \"required_dependencies\": [\"transformed_db_dataset\", \"transformed_file_dataset\"], \"optional_dependencies\": [], \"source\": \"def joined_dataset(transformed_file_dataset: pd.DataFrame, transformed_db_dataset: pd.DataFrame) -> pd.DataFrame:\\n    return pd.concat([transformed_file_dataset, transformed_db_dataset], axis=1)\\n\", \"documentation\": \"\", \"version\": \"8d0bde3bcb31f4295da0edca891b74d445489f61a764cbae55965b7329cc0f5c\"}, {\"name\": \"saved_file\", \"tags\": {\"module\": \"__main__\", \"hamilton.data_saver\": true, \"hamilton.data_saver.sink\": \"saved_file\", \"hamilton.data_saver.classname\": \"saved_file()\"}, \"output_type\": \"dict\", \"required_dependencies\": [\"file_path\", \"fit_model\"], \"optional_dependencies\": [], \"source\": \"@datasaver()\\ndef saved_file(fit_model: ModelObject, file_path: str) -> dict:\\n    with open(file_path, \\\"wb\\\") as f:\\n        pickle.dump(fit_model, f)\\n    return utils.get_file_metadata(file_path)\\n\", \"documentation\": \"\", \"version\": \"2c9d53abd2e853734734aa9e086f8fc0d25d420c1dacab7221d054fd1db8bc31\"}, {\"name\": \"saved_to_db\", \"tags\": {\"module\": \"__main__\", \"hamilton.data_saver\": true, \"hamilton.data_saver.sink\": \"saved_to_db\", \"hamilton.data_saver.classname\": \"saved_to_db()\"}, \"output_type\": \"dict\", \"required_dependencies\": [\"db_client\", \"joined_dataset\", \"joined_table_name\"], \"optional_dependencies\": [], \"source\": \"@datasaver()\\ndef saved_to_db(joined_dataset: pd.DataFrame, db_client: object, joined_table_name: str) -> dict:\\n    # joined_dataset.to_sql(joined_table_name, con=db_client, index=False)\\n    return utils.get_sql_metadata(joined_table_name, joined_dataset)\\n\", \"documentation\": \"\", \"version\": \"c400aa21cd5095fdd4f0372a01cf65f2bde44e1785b754cd2e4a348c659fbb78\"}, {\"name\": \"transformed_db_dataset\", \"tags\": {\"module\": \"__main__\"}, \"output_type\": \"DataFrame\", \"required_dependencies\": [\"db_dataset\"], \"optional_dependencies\": [], \"source\": \"def transformed_db_dataset(db_dataset: pd.DataFrame) -> pd.DataFrame:\\n    return db_dataset\\n\", \"documentation\": \"\", \"version\": \"8ad08f1aa9bb5fcaab2aa413bbe61a906aa29a31a11b5e6f59c4920608631631\"}, {\"name\": \"transformed_file_dataset\", \"tags\": {\"module\": \"__main__\"}, \"output_type\": \"DataFrame\", \"required_dependencies\": [\"file_dataset\"], \"optional_dependencies\": [], \"source\": \"def transformed_file_dataset(file_dataset: pd.DataFrame) -> pd.DataFrame:\\n    return file_dataset\\n\", \"documentation\": \"\", \"version\": \"4e4b1e73f88e0bfd4e1bd80acdfcdde56e072a3bc1f04f392f9b49d70ca25d55\"}, {\"name\": \"db_client\", \"tags\": {}, \"output_type\": \"object\", \"required_dependencies\": [], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef db_dataset(db_client: object) -> Tuple[pd.DataFrame, dict]:\\n    query = \\\"SELECT * FROM purchase_data\\\"\\n    return pd.read_sql(query, con=db_client), {\\\"sql_metadata\\\": {\\\"query\\\": query, \\\"table_name\\\": \\\"purchase_data\\\", \\\"database\\\": \\\"sqlite\\\"}}\\n\", \"documentation\": \"\", \"version\": \"7903e84928e9adc7575d7285170c9f2f2855a5adb2f5924656cd7fb01377ee8b\"}, {\"name\": \"file_ds_path\", \"tags\": {}, \"output_type\": \"str\", \"required_dependencies\": [], \"optional_dependencies\": [], \"source\": \"@dataloader()\\ndef file_dataset(file_ds_path: str) -> Tuple[pd.DataFrame, dict]:\\n    # TODO: metadata\\n    df = pd.read_csv(file_ds_path)\\n    return df, utils.get_file_metadata(file_ds_path)\\n\", \"documentation\": \"\", \"version\": \"fe990a80cc2567d540dc183f180c86d3a77b72224d180a95d1719cc766ccb5fa\"}, {\"name\": \"file_path\", \"tags\": {}, \"output_type\": \"str\", \"required_dependencies\": [], \"optional_dependencies\": [], \"source\": \"@datasaver()\\ndef saved_file(fit_model: ModelObject, file_path: str) -> dict:\\n    with open(file_path, \\\"wb\\\") as f:\\n        pickle.dump(fit_model, f)\\n    return utils.get_file_metadata(file_path)\\n\", \"documentation\": \"\", \"version\": \"2c9d53abd2e853734734aa9e086f8fc0d25d420c1dacab7221d054fd1db8bc31\"}, {\"name\": \"joined_table_name\", \"tags\": {}, \"output_type\": \"str\", \"required_dependencies\": [], \"optional_dependencies\": [], \"source\": \"@datasaver()\\ndef saved_to_db(joined_dataset: pd.DataFrame, db_client: object, joined_table_name: str) -> dict:\\n    # joined_dataset.to_sql(joined_table_name, con=db_client, index=False)\\n    return utils.get_sql_metadata(joined_table_name, joined_dataset)\\n\", \"documentation\": \"\", \"version\": \"c400aa21cd5095fdd4f0372a01cf65f2bde44e1785b754cd2e4a348c659fbb78\"}]"}}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {"hamilton": {"_producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "_schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunFacet", "final_vars": ["saved_file", "saved_to_db"], "graph_version": "a99f19f71a105eef8bf173584b7f920f55603604e92048630ff90cd614356316", "hamilton_run_id": "44e06d84-7946-460c-8795-04ca195f647d", "inputs": ["db_client", "file_ds_path", "file_path", "joined_table_name"], "overrides": []}}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
{"eventTime": "2024-09-05T07:00:38.479558+00:00", "eventType": "RUNNING", "inputs": [{"facets": {}, "inputFacets": {}, "name": "file_dataset.loader", "namespace": "my_namespace"}], "job": {"facets": {}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
{"eventTime": "2024-09-05T07:00:38.483375+00:00", "eventType": "RUNNING", "inputs": [{"facets": {}, "inputFacets": {}, "name": "purchase_data", "namespace": "my_namespace"}], "job": {"facets": {}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
{"eventTime": "2024-09-05T07:00:38.486322+00:00", "eventType": "RUNNING", "inputs": [], "job": {"facets": {}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [{"facets": {}, "name": "model.pkl", "namespace": "my_namespace", "outputFacets": {}}], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
{"eventTime": "2024-09-05T07:00:38.486713+00:00", "eventType": "RUNNING", "inputs": [], "job": {"facets": {}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [{"facets": {}, "name": "joined_data", "namespace": "my_namespace", "outputFacets": {}}], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
{"eventTime": "2024-09-05T07:00:38.487033+00:00", "eventType": "COMPLETE", "inputs": [], "job": {"facets": {}, "name": "test_job", "namespace": "my_namespace"}, "outputs": [], "producer": "https://github.com/OpenLineage/OpenLineage/tree/1.21.1/client/python", "run": {"facets": {}, "runId": "44e06d84-7946-460c-8795-04ca195f647d"}, "schemaURL": "https://openlineage.io/spec/2-0-2/OpenLineage.json#/$defs/RunEvent"}
